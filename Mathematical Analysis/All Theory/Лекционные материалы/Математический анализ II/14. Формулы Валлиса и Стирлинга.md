Формула Валлиса

Формула Стирлинга

---

## ==Формула Валлиса==

> В этом пункте мы докажем так называемую формулу Валлиса — исторически первое представление числа $\pi$﻿ как предела последовательности рациональных чисел. Эта формула будет появляться и, честно говоря, выручать нас в самых разных ситуациях. В частности, она уже понадобится нам во втором пункте этого раздела — при выводе формулы Стирлинга.

Итак, сформулируем саму теорему.

> [!important]  
> [ Теорема ] (формула Валлиса)@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')π=lim⁡n→+∞1n((2n)!!(2n−1)!!)2.\pi = \lim\limits_{n \to + \infty} \frac{1}{n}\left(\frac{(2n)!!}{(2n-1)!!}\right)^2.π=n→+∞lim​n1​((2n−1)!!(2n)!!​)2.Доказательство.Ясно, что при @import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')x∈(0,π2)x \in (0, \frac{\pi}{2})x∈(0,2π​)﻿, @import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')n∈Nn \in \mathbb{N}n∈N﻿, справедлива следующая цепочка неравенств:@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')sin⁡2n+1x<sin⁡2nx<sin⁡2n−1x.\sin^{2n+1}x < \sin^{2n}x < \sin^{2n - 1}x.sin2n+1x<sin2nx<sin2n−1x.Обозначив@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')In:=∫0π/2sin⁡nx dx,I_n := \int\limits_0^{\pi/2} \sin^n x \ dx,In​:=0∫π/2​sinnx dx,получим @import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')I2n+1<I2n<I2n−1,I_{2n + 1} < I_{2n} < I_{2n-1},I2n+1​<I2n​<I2n−1​,﻿ [[12. Формулы интегрирования по частям и замены переменной]]@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')(2n)!!(2n+1)!!<π2⋅(2n−1)!!(2n)!!<(2n−2)!!(2n−1)!!\frac{(2n)!!}{(2n+1)!!} < \frac{\pi}{2} \cdot \frac{(2n - 1)!!}{(2n)!!} < \frac{(2n - 2)!!}{(2 n -1)!!}(2n+1)!!(2n)!!​<2π​⋅(2n)!!(2n−1)!!​<(2n−1)!!(2n−2)!!​или@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')12n+1((2n)!!(2n−1)!!)2<π2<12n((2n)!!(2n−1)!!)2.\frac{1}{2n + 1}\left(\frac{(2n)!!}{(2n - 1)!!}\right)^2 < \frac{\pi}{2} < \frac{1}{2n}\left(\frac{(2n)!!}{(2n - 1)!!}\right)^2.2n+11​((2n−1)!!(2n)!!​)2<2π​<2n1​((2n−1)!!(2n)!!​)2.Пусть@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')xn=1n((2n)!!(2n−1)!!)2,x_n = \frac{1}{n}\left(\frac{(2n)!!}{(2n - 1)!!} \right)^2,xn​=n1​((2n−1)!!(2n)!!​)2,тогда@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')π<xn<2n+12nπ,\pi < x_n < \frac{2n + 1}{2n} \pi,π<xn​<2n2n+1​π,откуда, по теореме о сжатой переменной, получается требуемое.  

Перейдем теперь к рассмотрению формулы Стирлинга.

---

## ==Формула Стирлинга==

> Мы знаем, что факториал растет быстрее, чем показательная, степенная, логарифмическая функции. Но как и с чем сравнить его рост, если нас не устраивает такая характеристика, как «быстрее»? Точнее — чему эквивалентен $n!$﻿ при больших значениях $n$﻿? На этот вопрос дает ответ формула Стирлинга.

Предпошлем формуле Стирлинга такое вспомогательное, легко получаемое из геометричских соображений, неравенство.

> [!important]  
> [ Лемма ] (одно неравенство для логарифма)Для натуральных значений @import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')nnn﻿ справедливо неравенство@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')1n+1/2<ln⁡(1+1n)<12(1n+1n+1).\frac{1}{n + 1/2} < \ln \left( 1 + \frac{1}{n}\right) < \frac{1}{2}\left(\frac{1}{n} + \frac{1}{n + 1} \right).n+1/21​<ln(1+n1​)<21​(n1​+n+11​).Доказательство.Доказательство данного неравенства легко провести из геометрических соображений. Рассмотрим график гиперболы @import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')y=1/xy=1/xy=1/x﻿ на отрезке @import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')Δn=[n,n+1]\Delta_n = [n, n+1]Δn​=[n,n+1]﻿, @import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')n∈Nn\in \mathbb Nn∈N﻿. Площадь под гиперболой на @import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')Δn\Delta_nΔn​﻿ меньше площади прямоугольной трапеции с основаниями, равными @import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')1/n1/n1/n﻿ и @import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')1/(n+1)1/(n+1)1/(n+1)﻿ высоты @import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')111﻿, численно равной@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')12(1n+1n+1),\frac{1}{2}\left(\frac{1}{n} + \frac{1}{n + 1} \right),21​(n1​+n+11​),что совпадает с выражением, стоящим в правой части доказываемого неравенства.Наоборот, так как гипербола — выпуклая вниз функция, то площадь под гиперболой на @import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')Δn\Delta_nΔn​﻿ больше, чем площадь прямоугольной трапеции, одна из сторон которой касается гиперболы в точке @import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')(n+1/2)(n+ 1/2)(n+1/2)﻿. Площадь такой трапеции численно равна@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')1n+1/2,\frac{1}{n + 1/2},n+1/21​,что совпадает с выражением, стоящим в левой части доказываемого неравенства. Площадь же под самой гиперболой равна@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')∫nn+1dxx=ln⁡(n+1)−ln⁡n=ln⁡(1+1n),\int\limits_n^{n+1} \frac{dx}{x} = \ln(n + 1) - \ln n = \ln \left( 1 + \frac{1}{n}\right),n∫n+1​xdx​=ln(n+1)−lnn=ln(1+n1​),и, тем самым, рассматриваемое неравенство доказано.  

Теперь докажем формулу Стирлинга.

> [!important]  
> [ Теорема ] (формула Стирлинга)@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')n!=(ne)n2πn eθ/(4n),θ∈[0,1].n! = \left( \frac{n}{e}\right)^n\sqrt{2\pi n}\ e^{\theta/(4n)}, \quad \theta \in [0, 1].n!=(en​)n2πn​ eθ/(4n),θ∈[0,1].Доказательство.Рассмотрим последовательность@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')xn=n!ennn+1/2.x_n = \frac{n! e^n}{n^{n+1/2}}.xn​=nn+1/2n!en​.Покажем, что она убывает и ограничена снизу. Так как@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')xnxn+1=1e(1+1n)n+1/2,\frac{x_n}{x_{n+1}} = \frac{1}{e}\left(1 + \frac{1}{n}\right)^{n + 1/2},xn+1​xn​​=e1​(1+n1​)n+1/2,то@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')ln⁡xnxn+1=(n+12)ln⁡(1+1n)−1.\ln \frac{x_n}{x_{n+1}} = \left(n + \frac{1}{2}\right)\ln \left(1 + \frac{1}{n} \right) - 1.lnxn+1​xn​​=(n+21​)ln(1+n1​)−1.Согласно предыдущей [[14. Формулы Валлиса и Стирлинга]], справедливо следующее неравенство:@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')1n+1/2<ln⁡(1+1n)<12(1n+1n+1).\frac{1}{n + 1/2} < \ln \left(1 + \frac{1}{n} \right) < \frac{1}{2}\left(\frac{1}{n} + \frac{1}{n + 1} \right).n+1/21​<ln(1+n1​)<21​(n1​+n+11​).Умножив все неравенство на @import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')(n+1/2)(n + 1/2)(n+1/2)﻿, получим@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')1<(n+12)ln⁡(1+1n)<(n+1/2)2n(n+1).1 < \left(n + \frac{1}{2}\right)\ln \left(1 + \frac{1}{n} \right) < \frac{(n + 1/2)^2}{n(n+1)}.1<(n+21​)ln(1+n1​)<n(n+1)(n+1/2)2​.Вычтем из всех частей неравенства единицу, тогда получим@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')0<(n+12)ln⁡(1+1n)−1<(n+1/2)2n(n+1)−1=14n(n+1).0 < \left(n + \frac{1}{2}\right)\ln \left(1 + \frac{1}{n} \right) - 1 < \frac{(n + 1/2)^2}{n(n+1)} - 1 = \frac{1}{4n(n+1)}.0<(n+21​)ln(1+n1​)−1<n(n+1)(n+1/2)2​−1=4n(n+1)1​.откуда, в силу ранее обозначенного [[14. Формулы Валлиса и Стирлинга]],@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')xnxn+1>1,\frac{x_n}{x_{n+1}} > 1,xn+1​xn​​>1,а значит последовательность @import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')xnx_nxn​﻿ убывает. Так как она ограничена снизу (например, нулем), то, согласно теореме Вейерштрасса, она имеет предел. Обозначим его @import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')AAA﻿.Подставим вместо @import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')nnn﻿ в [[14. Формулы Валлиса и Стирлинга]] значения @import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')nnn﻿,@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')(n+1)(n+1)(n+1)﻿, @import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')(n+2)(n+2)(n+2)﻿, ..., @import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')(n+k−1)(n+k-1)(n+k−1)﻿ и сложим, тогда получим@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')0<ln⁡xnxn+k<14n(n+1)+14(n+1)(n+2)+...+14(n+k−1)(n+k)=0 < \ln \frac{x_n}{x_{n + k}} < \frac{1}{4n(n+1)} + \frac{1}{4(n+1)(n+2)} + ... + \frac{1}{4(n+k-1)(n+k)} =0<lnxn+k​xn​​<4n(n+1)1​+4(n+1)(n+2)1​+...+4(n+k−1)(n+k)1​=@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')=14(1n−1n+k),= \frac{1}{4}\left(\frac{1}{n} - \frac{1}{n + k} \right),=41​(n1​−n+k1​),откуда@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')1<xnxn+k<e14(1n−1n+k).1 < \frac{x_n}{x_{n+k}} < e^{\frac{1}{4}\left(\frac{1}{n} - \frac{1}{n + k} \right)}.1<xn+k​xn​​<e41​(n1​−n+k1​).Пусть @import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')k→+∞k \to + \inftyk→+∞﻿, тогда@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')1≤xnA≤e1/(4n)1 \leq \frac{x_n}{A} \leq e^{1/(4n)}1≤Axn​​≤e1/(4n)и, значит, @import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')A≠0A \neq 0A=0﻿. В итоге,@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')A≤xn≤Ae1/(4n),A \leq x_n \leq A e^{1/(4n)},A≤xn​≤Ae1/(4n),а значит@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')xn=Aeθ/(4n),θ∈[0,1].x_n = Ae^{\theta/(4n)}, \quad \theta \in [0, 1].xn​=Aeθ/(4n),θ∈[0,1].Осталось найти @import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')AAA﻿. Согласно формуле [[14. Формулы Валлиса и Стирлинга]],@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')π=lim⁡n→+∞1n(2n)!!(2n−1)!!=lim⁡n→+∞1n((2n)!!)2(2n)!=lim⁡n→+∞22n(n!)2n(2n)!.\sqrt{\pi} = \lim\limits_{n \to + \infty} \frac{1}{\sqrt{n}}\frac{(2n)!!}{(2n-1)!!} = \lim\limits_{n \to + \infty} \frac{1}{\sqrt{n}}\frac{((2n)!!)^2}{(2n)!} = \lim\limits_{n \to + \infty} \frac{2^{2n}(n!)^2}{\sqrt{n}(2n)!}.π​=n→+∞lim​n​1​(2n−1)!!(2n)!!​=n→+∞lim​n​1​(2n)!((2n)!!)2​=n→+∞lim​n​(2n)!22n(n!)2​.С другой стороны,@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')xn2x2n=2(n!)222n(2n)!n→n→+∞2π.\frac{x_n^2}{x_{2n}} = \sqrt{2}\frac{(n!)^22^{2n}}{(2n)!\sqrt{n}} \xrightarrow[n \to + \infty]{}\sqrt{2\pi}.x2n​xn2​​=2​(2n)!n​(n!)222n​n→+∞​2π​.Левая же часть в равенстве выше стремится к @import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')AAA﻿. Тем самым,@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')xn=2πeθ/(4n),θ∈[0,1].x_n = \sqrt{2\pi}e^{\theta/(4n)}, \quad \theta \in [0, 1].xn​=2π​eθ/(4n),θ∈[0,1].что и доказывает утверждение теоремы.  

Отметим отдельно важное для практики следствие.

> [!important]  
> [ Следствие ]@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')n!∼(ne)n2πn,n→+∞.n! \sim \left( \frac{n}{e}\right)^n\sqrt{2\pi n}, \quad n \to +\infty.n!∼(en​)n2πn​,n→+∞.  

Заметим также, что справедлива более точная формула, которую сейчас мы доказывать не будем.

> [!important]  
> [ NB ]На самом деле можно доказать, что@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')n!=(ne)n2πn eθ/12n, θ∈[0,1].n! = \left( \frac{n}{e}\right)^n\sqrt{2\pi n} \ e^{\theta/12n}, \ \theta \in [0, 1].n!=(en​)n2πn​ eθ/12n, θ∈[0,1].